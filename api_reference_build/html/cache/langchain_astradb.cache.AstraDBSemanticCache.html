

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en"> <!--<![endif]-->
<head>
    <meta charset="utf-8">
    <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    
        <title>langchain_astradb.cache.AstraDBSemanticCache &mdash; 🦜🔗 LangChain 0.2.17</title>
    
    <link rel="canonical"
          href="https://api.python.langchain.com/en/latest/cache/langchain_astradb.cache.AstraDBSemanticCache.html"/>

    

    <link rel="stylesheet"
          href="../_static/css/vendor/bootstrap.min.css"
          type="text/css"/>
            <link rel="stylesheet" href="../_static/pygments.css" type="text/css"/>
            <link rel="stylesheet" href="../_static/css/theme.css" type="text/css"/>
            <link rel="stylesheet" href="../_static/autodoc_pydantic.css" type="text/css"/>
            <link rel="stylesheet" href="../_static/copybutton.css" type="text/css"/>
            <link rel="stylesheet" href="../_static/sphinx-dropdown.css" type="text/css"/>
            <link rel="stylesheet" href="../_static/panels-bootstrap.min.css" type="text/css"/>
            <link rel="stylesheet" href="../_static/css/custom.css" type="text/css"/>
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css"/>
    <script id="documentation_options" data-url_root="../"
            src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script> 
</head>
<body>
<div class="banner">
    <p>This is a legacy site. Please use the latest <a href="https://python.langchain.com/v0.2/api_reference/reference.html">v0.2</a> and <a href="https://python.langchain.com/api_reference/">v0.3</a> API references instead.</p>
</div>


<nav id="navbar" class="sk-docs-navbar navbar navbar-expand-md navbar-light bg-light py-0">
  <div class="container-fluid sk-docs-container px-0">
    <button
      id="sk-navbar-toggler"
      class="navbar-toggler"
      type="button"
      data-toggle="collapse"
      data-target="#navbarSupportedContent"
      aria-controls="navbarSupportedContent"
      aria-expanded="false"
      aria-label="Toggle navigation"
    >
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="sk-navbar-collapse collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav mr-auto">
        <li class="nav-item">
          <a class="sk-nav-link nav-link" href="../langchain_api_reference.html">LangChain</a>
        </li>
        <li class="nav-item">
          <a class="sk-nav-link nav-link" href="../core_api_reference.html">Core</a>
        </li>
        <li class="nav-item">
          <a class="sk-nav-link nav-link" href="../community_api_reference.html">Community</a>
        </li>
        <li class="nav-item">
          <a class="sk-nav-link nav-link" href="../experimental_api_reference.html">Experimental</a>
        </li>
        <li class="nav-item">
          <a class="sk-nav-link nav-link" href="../text_splitters_api_reference.html">Text splitters</a>
        </li>
        <li class="nav-item">
          <a class="sk-nav-link nav-link nav-more-item-mobile-items" href="../ai21_api_reference.html">ai21</a>
        </li>
        <li class="nav-item">
          <a class="sk-nav-link nav-link nav-more-item-mobile-items" href="../airbyte_api_reference.html">airbyte</a>
        </li>
        <li class="nav-item">
          <a class="sk-nav-link nav-link nav-more-item-mobile-items" href="../anthropic_api_reference.html">anthropic</a>
        </li>
        <li class="nav-item">
          <a class="sk-nav-link nav-link nav-more-item-mobile-items" href="../astradb_api_reference.html">astradb</a>
        </li>
        <li class="nav-item">
          <a class="sk-nav-link nav-link nav-more-item-mobile-items" href="../aws_api_reference.html">aws</a>
        </li>
        <li class="nav-item">
          <a class="sk-nav-link nav-link nav-more-item-mobile-items" href="../azure_dynamic_sessions_api_reference.html">azure-dynamic-sessions</a>
        </li>
        <li class="nav-item">
          <a class="sk-nav-link nav-link nav-more-item-mobile-items" href="../box_api_reference.html">box</a>
        </li>
        <li class="nav-item">
          <a class="sk-nav-link nav-link nav-more-item-mobile-items" href="../chroma_api_reference.html">chroma</a>
        </li>
        <li class="nav-item">
          <a class="sk-nav-link nav-link nav-more-item-mobile-items" href="../cohere_api_reference.html">cohere</a>
        </li>
        <li class="nav-item">
          <a class="sk-nav-link nav-link nav-more-item-mobile-items" href="../couchbase_api_reference.html">couchbase</a>
        </li>
        <li class="nav-item">
          <a class="sk-nav-link nav-link nav-more-item-mobile-items" href="../elasticsearch_api_reference.html">elasticsearch</a>
        </li>
        <li class="nav-item">
          <a class="sk-nav-link nav-link nav-more-item-mobile-items" href="../exa_api_reference.html">exa</a>
        </li>
        <li class="nav-item">
          <a class="sk-nav-link nav-link nav-more-item-mobile-items" href="../fireworks_api_reference.html">fireworks</a>
        </li>
        <li class="nav-item">
          <a class="sk-nav-link nav-link nav-more-item-mobile-items" href="../google_community_api_reference.html">google-community</a>
        </li>
        <li class="nav-item">
          <a class="sk-nav-link nav-link nav-more-item-mobile-items" href="../google_genai_api_reference.html">google-genai</a>
        </li>
        <li class="nav-item">
          <a class="sk-nav-link nav-link nav-more-item-mobile-items" href="../google_vertexai_api_reference.html">google-vertexai</a>
        </li>
        <li class="nav-item">
          <a class="sk-nav-link nav-link nav-more-item-mobile-items" href="../groq_api_reference.html">groq</a>
        </li>
        <li class="nav-item">
          <a class="sk-nav-link nav-link nav-more-item-mobile-items" href="../huggingface_api_reference.html">huggingface</a>
        </li>
        <li class="nav-item">
          <a class="sk-nav-link nav-link nav-more-item-mobile-items" href="../ibm_api_reference.html">ibm</a>
        </li>
        <li class="nav-item">
          <a class="sk-nav-link nav-link nav-more-item-mobile-items" href="../milvus_api_reference.html">milvus</a>
        </li>
        <li class="nav-item">
          <a class="sk-nav-link nav-link nav-more-item-mobile-items" href="../mistralai_api_reference.html">mistralai</a>
        </li>
        <li class="nav-item">
          <a class="sk-nav-link nav-link nav-more-item-mobile-items" href="../mongodb_api_reference.html">mongodb</a>
        </li>
        <li class="nav-item">
          <a class="sk-nav-link nav-link nav-more-item-mobile-items" href="../nomic_api_reference.html">nomic</a>
        </li>
        <li class="nav-item">
          <a class="sk-nav-link nav-link nav-more-item-mobile-items" href="../nvidia_ai_endpoints_api_reference.html">nvidia-ai-endpoints</a>
        </li>
        <li class="nav-item">
          <a class="sk-nav-link nav-link nav-more-item-mobile-items" href="../ollama_api_reference.html">ollama</a>
        </li>
        <li class="nav-item">
          <a class="sk-nav-link nav-link nav-more-item-mobile-items" href="../openai_api_reference.html">openai</a>
        </li>
        <li class="nav-item">
          <a class="sk-nav-link nav-link nav-more-item-mobile-items" href="../pinecone_api_reference.html">pinecone</a>
        </li>
        <li class="nav-item">
          <a class="sk-nav-link nav-link nav-more-item-mobile-items" href="../postgres_api_reference.html">postgres</a>
        </li>
        <li class="nav-item">
          <a class="sk-nav-link nav-link nav-more-item-mobile-items" href="../prompty_api_reference.html">prompty</a>
        </li>
        <li class="nav-item">
          <a class="sk-nav-link nav-link nav-more-item-mobile-items" href="../qdrant_api_reference.html">qdrant</a>
        </li>
        <li class="nav-item">
          <a class="sk-nav-link nav-link nav-more-item-mobile-items" href="../robocorp_api_reference.html">robocorp</a>
        </li>
        <li class="nav-item">
          <a class="sk-nav-link nav-link nav-more-item-mobile-items" href="../together_api_reference.html">together</a>
        </li>
        <li class="nav-item">
          <a class="sk-nav-link nav-link nav-more-item-mobile-items" href="../unstructured_api_reference.html">unstructured</a>
        </li>
        <li class="nav-item">
          <a class="sk-nav-link nav-link nav-more-item-mobile-items" href="../voyageai_api_reference.html">voyageai</a>
        </li>
        <li class="nav-item">
          <a class="sk-nav-link nav-link nav-more-item-mobile-items" href="../weaviate_api_reference.html">weaviate</a>
        </li>
        <li class="nav-item dropdown nav-more-item-dropdown">
          <a class="sk-nav-link nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Partner libs</a>
          <div class="dropdown-menu" aria-labelledby="navbarDropdown">
              <a class="sk-nav-dropdown-item dropdown-item" href="../ai21_api_reference.html">ai21</a>
              <a class="sk-nav-dropdown-item dropdown-item" href="../airbyte_api_reference.html">airbyte</a>
              <a class="sk-nav-dropdown-item dropdown-item" href="../anthropic_api_reference.html">anthropic</a>
              <a class="sk-nav-dropdown-item dropdown-item" href="../astradb_api_reference.html">astradb</a>
              <a class="sk-nav-dropdown-item dropdown-item" href="../aws_api_reference.html">aws</a>
              <a class="sk-nav-dropdown-item dropdown-item" href="../azure_dynamic_sessions_api_reference.html">azure-dynamic-sessions</a>
              <a class="sk-nav-dropdown-item dropdown-item" href="../box_api_reference.html">box</a>
              <a class="sk-nav-dropdown-item dropdown-item" href="../chroma_api_reference.html">chroma</a>
              <a class="sk-nav-dropdown-item dropdown-item" href="../cohere_api_reference.html">cohere</a>
              <a class="sk-nav-dropdown-item dropdown-item" href="../couchbase_api_reference.html">couchbase</a>
              <a class="sk-nav-dropdown-item dropdown-item" href="../elasticsearch_api_reference.html">elasticsearch</a>
              <a class="sk-nav-dropdown-item dropdown-item" href="../exa_api_reference.html">exa</a>
              <a class="sk-nav-dropdown-item dropdown-item" href="../fireworks_api_reference.html">fireworks</a>
              <a class="sk-nav-dropdown-item dropdown-item" href="../google_community_api_reference.html">google-community</a>
              <a class="sk-nav-dropdown-item dropdown-item" href="../google_genai_api_reference.html">google-genai</a>
              <a class="sk-nav-dropdown-item dropdown-item" href="../google_vertexai_api_reference.html">google-vertexai</a>
              <a class="sk-nav-dropdown-item dropdown-item" href="../groq_api_reference.html">groq</a>
              <a class="sk-nav-dropdown-item dropdown-item" href="../huggingface_api_reference.html">huggingface</a>
              <a class="sk-nav-dropdown-item dropdown-item" href="../ibm_api_reference.html">ibm</a>
              <a class="sk-nav-dropdown-item dropdown-item" href="../milvus_api_reference.html">milvus</a>
              <a class="sk-nav-dropdown-item dropdown-item" href="../mistralai_api_reference.html">mistralai</a>
              <a class="sk-nav-dropdown-item dropdown-item" href="../mongodb_api_reference.html">mongodb</a>
              <a class="sk-nav-dropdown-item dropdown-item" href="../nomic_api_reference.html">nomic</a>
              <a class="sk-nav-dropdown-item dropdown-item" href="../nvidia_ai_endpoints_api_reference.html">nvidia-ai-endpoints</a>
              <a class="sk-nav-dropdown-item dropdown-item" href="../ollama_api_reference.html">ollama</a>
              <a class="sk-nav-dropdown-item dropdown-item" href="../openai_api_reference.html">openai</a>
              <a class="sk-nav-dropdown-item dropdown-item" href="../pinecone_api_reference.html">pinecone</a>
              <a class="sk-nav-dropdown-item dropdown-item" href="../postgres_api_reference.html">postgres</a>
              <a class="sk-nav-dropdown-item dropdown-item" href="../prompty_api_reference.html">prompty</a>
              <a class="sk-nav-dropdown-item dropdown-item" href="../qdrant_api_reference.html">qdrant</a>
              <a class="sk-nav-dropdown-item dropdown-item" href="../robocorp_api_reference.html">robocorp</a>
              <a class="sk-nav-dropdown-item dropdown-item" href="../together_api_reference.html">together</a>
              <a class="sk-nav-dropdown-item dropdown-item" href="../unstructured_api_reference.html">unstructured</a>
              <a class="sk-nav-dropdown-item dropdown-item" href="../voyageai_api_reference.html">voyageai</a>
              <a class="sk-nav-dropdown-item dropdown-item" href="../weaviate_api_reference.html">weaviate</a>
          </div>
        </li>
        <li class="nav-item">
          <a class="sk-nav-link nav-link" target="_blank" rel="noopener noreferrer" href="https://python.langchain.com/">Docs</a>
        </li>
      </ul>
      <div id="searchbox" role="search">
          <div class="searchformwrapper">
          <form class="search" action="../search.html" method="get">
            <input class="sk-search-text-input" type="text" name="q" aria-labelledby="searchlabel" />
            <input class="sk-search-text-btn" type="submit" value="Go" />
          </form>
          </div>
      </div>
    </div>
  </div>
</nav>
    <div class="d-flex" id="sk-doc-wrapper">
        <input type="checkbox" name="sk-toggle-checkbox" id="sk-toggle-checkbox">
        <label id="sk-sidemenu-toggle" class="sk-btn-toggle-toc btn sk-btn-primary"
               for="sk-toggle-checkbox">Toggle Menu</label>
        <div id="sk-sidebar-wrapper" class="border-right">
            <div class="sk-sidebar-toc-wrapper">
                    <div class="sk-sidebar-toc">
                        <ul>
<li><a class="reference internal" href="#"><code class="xref py py-mod docutils literal notranslate"><span class="pre">langchain_astradb.cache</span></code>.AstraDBSemanticCache</a><ul>
<li><a class="reference internal" href="#langchain_astradb.cache.AstraDBSemanticCache"><code class="docutils literal notranslate"><span class="pre">AstraDBSemanticCache</span></code></a><ul>
<li><a class="reference internal" href="#langchain_astradb.cache.AstraDBSemanticCache.__init__"><code class="docutils literal notranslate"><span class="pre">AstraDBSemanticCache.__init__()</span></code></a></li>
<li><a class="reference internal" href="#langchain_astradb.cache.AstraDBSemanticCache.aclear"><code class="docutils literal notranslate"><span class="pre">AstraDBSemanticCache.aclear()</span></code></a></li>
<li><a class="reference internal" href="#langchain_astradb.cache.AstraDBSemanticCache.adelete_by_document_id"><code class="docutils literal notranslate"><span class="pre">AstraDBSemanticCache.adelete_by_document_id()</span></code></a></li>
<li><a class="reference internal" href="#langchain_astradb.cache.AstraDBSemanticCache.alookup"><code class="docutils literal notranslate"><span class="pre">AstraDBSemanticCache.alookup()</span></code></a></li>
<li><a class="reference internal" href="#langchain_astradb.cache.AstraDBSemanticCache.alookup_with_id"><code class="docutils literal notranslate"><span class="pre">AstraDBSemanticCache.alookup_with_id()</span></code></a></li>
<li><a class="reference internal" href="#langchain_astradb.cache.AstraDBSemanticCache.alookup_with_id_through_llm"><code class="docutils literal notranslate"><span class="pre">AstraDBSemanticCache.alookup_with_id_through_llm()</span></code></a></li>
<li><a class="reference internal" href="#langchain_astradb.cache.AstraDBSemanticCache.aupdate"><code class="docutils literal notranslate"><span class="pre">AstraDBSemanticCache.aupdate()</span></code></a></li>
<li><a class="reference internal" href="#langchain_astradb.cache.AstraDBSemanticCache.clear"><code class="docutils literal notranslate"><span class="pre">AstraDBSemanticCache.clear()</span></code></a></li>
<li><a class="reference internal" href="#langchain_astradb.cache.AstraDBSemanticCache.delete_by_document_id"><code class="docutils literal notranslate"><span class="pre">AstraDBSemanticCache.delete_by_document_id()</span></code></a></li>
<li><a class="reference internal" href="#langchain_astradb.cache.AstraDBSemanticCache.lookup"><code class="docutils literal notranslate"><span class="pre">AstraDBSemanticCache.lookup()</span></code></a></li>
<li><a class="reference internal" href="#langchain_astradb.cache.AstraDBSemanticCache.lookup_with_id"><code class="docutils literal notranslate"><span class="pre">AstraDBSemanticCache.lookup_with_id()</span></code></a></li>
<li><a class="reference internal" href="#langchain_astradb.cache.AstraDBSemanticCache.lookup_with_id_through_llm"><code class="docutils literal notranslate"><span class="pre">AstraDBSemanticCache.lookup_with_id_through_llm()</span></code></a></li>
<li><a class="reference internal" href="#langchain_astradb.cache.AstraDBSemanticCache.update"><code class="docutils literal notranslate"><span class="pre">AstraDBSemanticCache.update()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

                    </div>
            </div>
        </div>
        <div id="sk-page-content-wrapper">
            <div class="sk-page-content container-fluid body px-md-3" role="main">
                
  <section id="langchain-astradb-cache-astradbsemanticcache">
<h1><a class="reference internal" href="../astradb_api_reference.html#module-langchain_astradb.cache" title="langchain_astradb.cache"><code class="xref py py-mod docutils literal notranslate"><span class="pre">langchain_astradb.cache</span></code></a>.AstraDBSemanticCache<a class="headerlink" href="#langchain-astradb-cache-astradbsemanticcache" title="Permalink to this heading">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="langchain_astradb.cache.AstraDBSemanticCache">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">langchain_astradb.cache.</span></span><span class="sig-name descname"><span class="pre">AstraDBSemanticCache</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collection_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'langchain_astradb_semantic_cache'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">token</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">TokenProvider</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">api_endpoint</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">environment</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astra_db_client</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../vectorstores/langchain_community.vectorstores.astradb.AstraDB.html#langchain_community.vectorstores.astradb.AstraDB" title="langchain_community.vectorstores.astradb.AstraDB"><span class="pre">AstraDB</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">async_astra_db_client</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">AsyncAstraDB</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">namespace</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">setup_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../utils/langchain_astradb.utils.astradb.SetupMode.html#langchain_astradb.utils.astradb.SetupMode" title="langchain_astradb.utils.astradb.SetupMode"><span class="pre">SetupMode</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">SetupMode.SYNC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_delete_collection</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../embeddings/langchain_core.embeddings.embeddings.Embeddings.html#langchain_core.embeddings.embeddings.Embeddings" title="langchain_core.embeddings.embeddings.Embeddings"><span class="pre">Embeddings</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">similarity_threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.85</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/langchain_astradb/cache.html#AstraDBSemanticCache"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#langchain_astradb.cache.AstraDBSemanticCache" title="Permalink to this definition">¶</a></dt>
<dd><p>Astra DB semantic cache.</p>
<p>Cache that uses Astra DB as a vector-store backend for semantic
(i.e. similarity-based) lookup.</p>
<p>It uses a single (vector) collection and can store
cached values from several LLMs, so the LLM’s ‘llm_string’ is stored
in the document metadata.</p>
<p>You can choose the preferred similarity (or use the API default).
The default score threshold is tuned to the default metric.
Tune it carefully yourself if switching to another distance metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>collection_name</strong> (<em>str</em>) – name of the Astra DB collection to create/use.</p></li>
<li><p><strong>token</strong> (<em>str</em><em> | </em><em>TokenProvider</em><em> | </em><em>None</em>) – API token for Astra DB usage, either in the form of a string
or a subclass of <cite>astrapy.authentication.TokenProvider</cite>.
If not provided, the environment variable
ASTRA_DB_APPLICATION_TOKEN is inspected.</p></li>
<li><p><strong>api_endpoint</strong> (<em>str</em><em> | </em><em>None</em>) – full URL to the API endpoint, such as
<cite>https://&lt;DB-ID&gt;-us-east1.apps.astra.datastax.com</cite>. If not provided,
the environment variable ASTRA_DB_API_ENDPOINT is inspected.</p></li>
<li><p><strong>environment</strong> (<em>str</em><em> | </em><em>None</em>) – a string specifying the environment of the target Data API.
If omitted, defaults to “prod” (Astra DB production).
Other values are in <cite>astrapy.constants.Environment</cite> enum class.</p></li>
<li><p><strong>astra_db_client</strong> (<a class="reference internal" href="../vectorstores/langchain_community.vectorstores.astradb.AstraDB.html#langchain_community.vectorstores.astradb.AstraDB" title="langchain_community.vectorstores.astradb.AstraDB"><em>AstraDB</em></a><em> | </em><em>None</em>) – <em>DEPRECATED starting from version 0.3.5.</em>
<em>Please use ‘token’, ‘api_endpoint’ and optionally ‘environment’.</em>
you can pass an already-created ‘astrapy.db.AstraDB’ instance
(alternatively to ‘token’, ‘api_endpoint’ and ‘environment’).</p></li>
<li><p><strong>async_astra_db_client</strong> (<em>AsyncAstraDB</em><em> | </em><em>None</em>) – <em>DEPRECATED starting from version 0.3.5.</em>
<em>Please use ‘token’, ‘api_endpoint’ and optionally ‘environment’.</em>
you can pass an already-created ‘astrapy.db.AsyncAstraDB’ instance
(alternatively to ‘token’, ‘api_endpoint’ and ‘environment’).</p></li>
<li><p><strong>namespace</strong> (<em>str</em><em> | </em><em>None</em>) – namespace (aka keyspace) where the collection is created.
If not provided, the environment variable ASTRA_DB_KEYSPACE is
inspected. Defaults to the database’s “default namespace”.</p></li>
<li><p><strong>setup_mode</strong> (<a class="reference internal" href="../utils/langchain_astradb.utils.astradb.SetupMode.html#langchain_astradb.utils.astradb.SetupMode" title="langchain_astradb.utils.astradb.SetupMode"><em>SetupMode</em></a>) – mode used to create the Astra DB collection (SYNC, ASYNC or
OFF).</p></li>
<li><p><strong>pre_delete_collection</strong> (<em>bool</em>) – whether to delete the collection
before creating it. If False and the collection already exists,
the collection will be used as is.</p></li>
<li><p><strong>embedding</strong> (<a class="reference internal" href="../embeddings/langchain_core.embeddings.embeddings.Embeddings.html#langchain_core.embeddings.embeddings.Embeddings" title="langchain_core.embeddings.embeddings.Embeddings"><em>Embeddings</em></a>) – Embedding provider for semantic encoding and search.</p></li>
<li><p><strong>metric</strong> (<em>str</em><em> | </em><em>None</em>) – the function to use for evaluating similarity of text embeddings.
Defaults to ‘cosine’ (alternatives: ‘euclidean’, ‘dot_product’)</p></li>
<li><p><strong>similarity_threshold</strong> (<em>float</em>) – the minimum similarity for accepting a
(semantic-search) match.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#langchain_astradb.cache.AstraDBSemanticCache.__init__" title="langchain_astradb.cache.AstraDBSemanticCache.__init__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__init__</span></code></a>(*[, collection_name, token, ...])</p></td>
<td><p>Astra DB semantic cache.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#langchain_astradb.cache.AstraDBSemanticCache.aclear" title="langchain_astradb.cache.AstraDBSemanticCache.aclear"><code class="xref py py-obj docutils literal notranslate"><span class="pre">aclear</span></code></a>(**kwargs)</p></td>
<td><p>Async clear cache that can take additional keyword arguments.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#langchain_astradb.cache.AstraDBSemanticCache.adelete_by_document_id" title="langchain_astradb.cache.AstraDBSemanticCache.adelete_by_document_id"><code class="xref py py-obj docutils literal notranslate"><span class="pre">adelete_by_document_id</span></code></a>(document_id)</p></td>
<td><p>Delete by document ID.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#langchain_astradb.cache.AstraDBSemanticCache.alookup" title="langchain_astradb.cache.AstraDBSemanticCache.alookup"><code class="xref py py-obj docutils literal notranslate"><span class="pre">alookup</span></code></a>(prompt, llm_string)</p></td>
<td><p>Async look up based on prompt and llm_string.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#langchain_astradb.cache.AstraDBSemanticCache.alookup_with_id" title="langchain_astradb.cache.AstraDBSemanticCache.alookup_with_id"><code class="xref py py-obj docutils literal notranslate"><span class="pre">alookup_with_id</span></code></a>(prompt, llm_string)</p></td>
<td><p>Look up based on prompt and llm_string.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#langchain_astradb.cache.AstraDBSemanticCache.alookup_with_id_through_llm" title="langchain_astradb.cache.AstraDBSemanticCache.alookup_with_id_through_llm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">alookup_with_id_through_llm</span></code></a>(prompt, llm[, stop])</p></td>
<td><p>Look up based on prompt and LLM.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#langchain_astradb.cache.AstraDBSemanticCache.aupdate" title="langchain_astradb.cache.AstraDBSemanticCache.aupdate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">aupdate</span></code></a>(prompt, llm_string, return_val)</p></td>
<td><p>Async update cache based on prompt and llm_string.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#langchain_astradb.cache.AstraDBSemanticCache.clear" title="langchain_astradb.cache.AstraDBSemanticCache.clear"><code class="xref py py-obj docutils literal notranslate"><span class="pre">clear</span></code></a>(**kwargs)</p></td>
<td><p>Clear cache that can take additional keyword arguments.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#langchain_astradb.cache.AstraDBSemanticCache.delete_by_document_id" title="langchain_astradb.cache.AstraDBSemanticCache.delete_by_document_id"><code class="xref py py-obj docutils literal notranslate"><span class="pre">delete_by_document_id</span></code></a>(document_id)</p></td>
<td><p>Delete by document ID.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#langchain_astradb.cache.AstraDBSemanticCache.lookup" title="langchain_astradb.cache.AstraDBSemanticCache.lookup"><code class="xref py py-obj docutils literal notranslate"><span class="pre">lookup</span></code></a>(prompt, llm_string)</p></td>
<td><p>Look up based on prompt and llm_string.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#langchain_astradb.cache.AstraDBSemanticCache.lookup_with_id" title="langchain_astradb.cache.AstraDBSemanticCache.lookup_with_id"><code class="xref py py-obj docutils literal notranslate"><span class="pre">lookup_with_id</span></code></a>(prompt, llm_string)</p></td>
<td><p>Look up based on prompt and llm_string.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#langchain_astradb.cache.AstraDBSemanticCache.lookup_with_id_through_llm" title="langchain_astradb.cache.AstraDBSemanticCache.lookup_with_id_through_llm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">lookup_with_id_through_llm</span></code></a>(prompt, llm[, stop])</p></td>
<td><p>Look up based on prompt and LLM.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#langchain_astradb.cache.AstraDBSemanticCache.update" title="langchain_astradb.cache.AstraDBSemanticCache.update"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update</span></code></a>(prompt, llm_string, return_val)</p></td>
<td><p>Update cache based on prompt and llm_string.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="langchain_astradb.cache.AstraDBSemanticCache.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collection_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'langchain_astradb_semantic_cache'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">token</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">TokenProvider</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">api_endpoint</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">environment</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astra_db_client</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../vectorstores/langchain_community.vectorstores.astradb.AstraDB.html#langchain_community.vectorstores.astradb.AstraDB" title="langchain_community.vectorstores.astradb.AstraDB"><span class="pre">AstraDB</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">async_astra_db_client</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">AsyncAstraDB</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">namespace</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">setup_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../utils/langchain_astradb.utils.astradb.SetupMode.html#langchain_astradb.utils.astradb.SetupMode" title="langchain_astradb.utils.astradb.SetupMode"><span class="pre">SetupMode</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">SetupMode.SYNC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_delete_collection</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../embeddings/langchain_core.embeddings.embeddings.Embeddings.html#langchain_core.embeddings.embeddings.Embeddings" title="langchain_core.embeddings.embeddings.Embeddings"><span class="pre">Embeddings</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">similarity_threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.85</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/langchain_astradb/cache.html#AstraDBSemanticCache.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#langchain_astradb.cache.AstraDBSemanticCache.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Astra DB semantic cache.</p>
<p>Cache that uses Astra DB as a vector-store backend for semantic
(i.e. similarity-based) lookup.</p>
<p>It uses a single (vector) collection and can store
cached values from several LLMs, so the LLM’s ‘llm_string’ is stored
in the document metadata.</p>
<p>You can choose the preferred similarity (or use the API default).
The default score threshold is tuned to the default metric.
Tune it carefully yourself if switching to another distance metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>collection_name</strong> (<em>str</em>) – name of the Astra DB collection to create/use.</p></li>
<li><p><strong>token</strong> (<em>str</em><em> | </em><em>TokenProvider</em><em> | </em><em>None</em>) – API token for Astra DB usage, either in the form of a string
or a subclass of <cite>astrapy.authentication.TokenProvider</cite>.
If not provided, the environment variable
ASTRA_DB_APPLICATION_TOKEN is inspected.</p></li>
<li><p><strong>api_endpoint</strong> (<em>str</em><em> | </em><em>None</em>) – full URL to the API endpoint, such as
<cite>https://&lt;DB-ID&gt;-us-east1.apps.astra.datastax.com</cite>. If not provided,
the environment variable ASTRA_DB_API_ENDPOINT is inspected.</p></li>
<li><p><strong>environment</strong> (<em>str</em><em> | </em><em>None</em>) – a string specifying the environment of the target Data API.
If omitted, defaults to “prod” (Astra DB production).
Other values are in <cite>astrapy.constants.Environment</cite> enum class.</p></li>
<li><p><strong>astra_db_client</strong> (<a class="reference internal" href="../vectorstores/langchain_community.vectorstores.astradb.AstraDB.html#langchain_community.vectorstores.astradb.AstraDB" title="langchain_community.vectorstores.astradb.AstraDB"><em>AstraDB</em></a><em> | </em><em>None</em>) – <em>DEPRECATED starting from version 0.3.5.</em>
<em>Please use ‘token’, ‘api_endpoint’ and optionally ‘environment’.</em>
you can pass an already-created ‘astrapy.db.AstraDB’ instance
(alternatively to ‘token’, ‘api_endpoint’ and ‘environment’).</p></li>
<li><p><strong>async_astra_db_client</strong> (<em>AsyncAstraDB</em><em> | </em><em>None</em>) – <em>DEPRECATED starting from version 0.3.5.</em>
<em>Please use ‘token’, ‘api_endpoint’ and optionally ‘environment’.</em>
you can pass an already-created ‘astrapy.db.AsyncAstraDB’ instance
(alternatively to ‘token’, ‘api_endpoint’ and ‘environment’).</p></li>
<li><p><strong>namespace</strong> (<em>str</em><em> | </em><em>None</em>) – namespace (aka keyspace) where the collection is created.
If not provided, the environment variable ASTRA_DB_KEYSPACE is
inspected. Defaults to the database’s “default namespace”.</p></li>
<li><p><strong>setup_mode</strong> (<a class="reference internal" href="../utils/langchain_astradb.utils.astradb.SetupMode.html#langchain_astradb.utils.astradb.SetupMode" title="langchain_astradb.utils.astradb.SetupMode"><em>SetupMode</em></a>) – mode used to create the Astra DB collection (SYNC, ASYNC or
OFF).</p></li>
<li><p><strong>pre_delete_collection</strong> (<em>bool</em>) – whether to delete the collection
before creating it. If False and the collection already exists,
the collection will be used as is.</p></li>
<li><p><strong>embedding</strong> (<a class="reference internal" href="../embeddings/langchain_core.embeddings.embeddings.Embeddings.html#langchain_core.embeddings.embeddings.Embeddings" title="langchain_core.embeddings.embeddings.Embeddings"><em>Embeddings</em></a>) – Embedding provider for semantic encoding and search.</p></li>
<li><p><strong>metric</strong> (<em>str</em><em> | </em><em>None</em>) – the function to use for evaluating similarity of text embeddings.
Defaults to ‘cosine’ (alternatives: ‘euclidean’, ‘dot_product’)</p></li>
<li><p><strong>similarity_threshold</strong> (<em>float</em>) – the minimum similarity for accepting a
(semantic-search) match.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="langchain_astradb.cache.AstraDBSemanticCache.aclear">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">aclear</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/langchain_astradb/cache.html#AstraDBSemanticCache.aclear"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#langchain_astradb.cache.AstraDBSemanticCache.aclear" title="Permalink to this definition">¶</a></dt>
<dd><p>Async clear cache that can take additional keyword arguments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kwargs</strong> (<em>Any</em>) – </p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="langchain_astradb.cache.AstraDBSemanticCache.adelete_by_document_id">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">adelete_by_document_id</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">document_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/langchain_astradb/cache.html#AstraDBSemanticCache.adelete_by_document_id"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#langchain_astradb.cache.AstraDBSemanticCache.adelete_by_document_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete by document ID.</p>
<p>Given this is a “similarity search” cache, an invalidation pattern
that makes sense is first a lookup to get an ID, and then deleting
with that ID. This is for the second step.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>document_id</strong> (<em>str</em>) – </p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="langchain_astradb.cache.AstraDBSemanticCache.alookup">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">alookup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prompt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">llm_string</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../outputs/langchain_core.outputs.generation.Generation.html#langchain_core.outputs.generation.Generation" title="langchain_core.outputs.generation.Generation"><span class="pre">Generation</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/langchain_astradb/cache.html#AstraDBSemanticCache.alookup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#langchain_astradb.cache.AstraDBSemanticCache.alookup" title="Permalink to this definition">¶</a></dt>
<dd><p>Async look up based on prompt and llm_string.</p>
<p>A cache implementation is expected to generate a key from the 2-tuple
of prompt and llm_string (e.g., by concatenating them with a delimiter).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prompt</strong> (<em>str</em>) – a string representation of the prompt.
In the case of a Chat model, the prompt is a non-trivial
serialization of the prompt into the language model.</p></li>
<li><p><strong>llm_string</strong> (<em>str</em>) – A string representation of the LLM configuration.
This is used to capture the invocation parameters of the LLM
(e.g., model name, temperature, stop tokens, max tokens, etc.).
These invocation parameters are serialized into a string
representation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>On a cache miss, return None. On a cache hit, return the cached value.
The cached value is a list of Generations (or subclasses).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><em>Optional</em>[<em>Sequence</em>[<a class="reference internal" href="../outputs/langchain_core.outputs.generation.Generation.html#langchain_core.outputs.generation.Generation" title="langchain_core.outputs.generation.Generation"><em>Generation</em></a>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="langchain_astradb.cache.AstraDBSemanticCache.alookup_with_id">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">alookup_with_id</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prompt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">llm_string</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../outputs/langchain_core.outputs.generation.Generation.html#langchain_core.outputs.generation.Generation" title="langchain_core.outputs.generation.Generation"><span class="pre">langchain_core.outputs.generation.Generation</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/langchain_astradb/cache.html#AstraDBSemanticCache.alookup_with_id"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#langchain_astradb.cache.AstraDBSemanticCache.alookup_with_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Look up based on prompt and llm_string.</p>
<p>If there are hits, return (document_id, cached_entry) for the top hit</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prompt</strong> (<em>str</em>) – </p></li>
<li><p><strong>llm_string</strong> (<em>str</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>tuple[str, <em>Sequence</em>[<a class="reference internal" href="../outputs/langchain_core.outputs.generation.Generation.html#langchain_core.outputs.generation.Generation" title="langchain_core.outputs.generation.Generation">langchain_core.outputs.generation.Generation</a>]] | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="langchain_astradb.cache.AstraDBSemanticCache.alookup_with_id_through_llm">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">alookup_with_id_through_llm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prompt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">llm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../language_models/langchain_core.language_models.llms.LLM.html#langchain_core.language_models.llms.LLM" title="langchain_core.language_models.llms.LLM"><span class="pre">LLM</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">RETURN_VAL_TYPE</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/langchain_astradb/cache.html#AstraDBSemanticCache.alookup_with_id_through_llm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#langchain_astradb.cache.AstraDBSemanticCache.alookup_with_id_through_llm" title="Permalink to this definition">¶</a></dt>
<dd><p>Look up based on prompt and LLM.</p>
<p>If there are hits, return (document_id, cached_entry) for the top hit</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prompt</strong> (<em>str</em>) – </p></li>
<li><p><strong>llm</strong> (<a class="reference internal" href="../language_models/langchain_core.language_models.llms.LLM.html#langchain_core.language_models.llms.LLM" title="langchain_core.language_models.llms.LLM"><em>LLM</em></a>) – </p></li>
<li><p><strong>stop</strong> (<em>list</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>tuple[str, RETURN_VAL_TYPE] | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="langchain_astradb.cache.AstraDBSemanticCache.aupdate">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">aupdate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prompt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">llm_string</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_val</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../outputs/langchain_core.outputs.generation.Generation.html#langchain_core.outputs.generation.Generation" title="langchain_core.outputs.generation.Generation"><span class="pre">Generation</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/langchain_astradb/cache.html#AstraDBSemanticCache.aupdate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#langchain_astradb.cache.AstraDBSemanticCache.aupdate" title="Permalink to this definition">¶</a></dt>
<dd><p>Async update cache based on prompt and llm_string.</p>
<p>The prompt and llm_string are used to generate a key for the cache.
The key should match that of the look up method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prompt</strong> (<em>str</em>) – a string representation of the prompt.
In the case of a Chat model, the prompt is a non-trivial
serialization of the prompt into the language model.</p></li>
<li><p><strong>llm_string</strong> (<em>str</em>) – A string representation of the LLM configuration.
This is used to capture the invocation parameters of the LLM
(e.g., model name, temperature, stop tokens, max tokens, etc.).
These invocation parameters are serialized into a string
representation.</p></li>
<li><p><strong>return_val</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="../outputs/langchain_core.outputs.generation.Generation.html#langchain_core.outputs.generation.Generation" title="langchain_core.outputs.generation.Generation"><em>Generation</em></a><em>]</em>) – The value to be cached. The value is a list of Generations
(or subclasses).</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="langchain_astradb.cache.AstraDBSemanticCache.clear">
<span class="sig-name descname"><span class="pre">clear</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/langchain_astradb/cache.html#AstraDBSemanticCache.clear"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#langchain_astradb.cache.AstraDBSemanticCache.clear" title="Permalink to this definition">¶</a></dt>
<dd><p>Clear cache that can take additional keyword arguments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kwargs</strong> (<em>Any</em>) – </p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="langchain_astradb.cache.AstraDBSemanticCache.delete_by_document_id">
<span class="sig-name descname"><span class="pre">delete_by_document_id</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">document_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/langchain_astradb/cache.html#AstraDBSemanticCache.delete_by_document_id"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#langchain_astradb.cache.AstraDBSemanticCache.delete_by_document_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete by document ID.</p>
<p>Given this is a “similarity search” cache, an invalidation pattern
that makes sense is first a lookup to get an ID, and then deleting
with that ID. This is for the second step.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>document_id</strong> (<em>str</em>) – </p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="langchain_astradb.cache.AstraDBSemanticCache.lookup">
<span class="sig-name descname"><span class="pre">lookup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prompt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">llm_string</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../outputs/langchain_core.outputs.generation.Generation.html#langchain_core.outputs.generation.Generation" title="langchain_core.outputs.generation.Generation"><span class="pre">Generation</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/langchain_astradb/cache.html#AstraDBSemanticCache.lookup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#langchain_astradb.cache.AstraDBSemanticCache.lookup" title="Permalink to this definition">¶</a></dt>
<dd><p>Look up based on prompt and llm_string.</p>
<p>A cache implementation is expected to generate a key from the 2-tuple
of prompt and llm_string (e.g., by concatenating them with a delimiter).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prompt</strong> (<em>str</em>) – a string representation of the prompt.
In the case of a Chat model, the prompt is a non-trivial
serialization of the prompt into the language model.</p></li>
<li><p><strong>llm_string</strong> (<em>str</em>) – A string representation of the LLM configuration.
This is used to capture the invocation parameters of the LLM
(e.g., model name, temperature, stop tokens, max tokens, etc.).
These invocation parameters are serialized into a string
representation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>On a cache miss, return None. On a cache hit, return the cached value.
The cached value is a list of Generations (or subclasses).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><em>Optional</em>[<em>Sequence</em>[<a class="reference internal" href="../outputs/langchain_core.outputs.generation.Generation.html#langchain_core.outputs.generation.Generation" title="langchain_core.outputs.generation.Generation"><em>Generation</em></a>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="langchain_astradb.cache.AstraDBSemanticCache.lookup_with_id">
<span class="sig-name descname"><span class="pre">lookup_with_id</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prompt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">llm_string</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../outputs/langchain_core.outputs.generation.Generation.html#langchain_core.outputs.generation.Generation" title="langchain_core.outputs.generation.Generation"><span class="pre">langchain_core.outputs.generation.Generation</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/langchain_astradb/cache.html#AstraDBSemanticCache.lookup_with_id"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#langchain_astradb.cache.AstraDBSemanticCache.lookup_with_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Look up based on prompt and llm_string.</p>
<p>If there are hits, return (document_id, cached_entry) for the top hit</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prompt</strong> (<em>str</em>) – </p></li>
<li><p><strong>llm_string</strong> (<em>str</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>tuple[str, <em>Sequence</em>[<a class="reference internal" href="../outputs/langchain_core.outputs.generation.Generation.html#langchain_core.outputs.generation.Generation" title="langchain_core.outputs.generation.Generation">langchain_core.outputs.generation.Generation</a>]] | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="langchain_astradb.cache.AstraDBSemanticCache.lookup_with_id_through_llm">
<span class="sig-name descname"><span class="pre">lookup_with_id_through_llm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prompt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">llm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../language_models/langchain_core.language_models.llms.LLM.html#langchain_core.language_models.llms.LLM" title="langchain_core.language_models.llms.LLM"><span class="pre">LLM</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">RETURN_VAL_TYPE</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/langchain_astradb/cache.html#AstraDBSemanticCache.lookup_with_id_through_llm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#langchain_astradb.cache.AstraDBSemanticCache.lookup_with_id_through_llm" title="Permalink to this definition">¶</a></dt>
<dd><p>Look up based on prompt and LLM.</p>
<p>If there are hits, return (document_id, cached_entry) for the top hit</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prompt</strong> (<em>str</em>) – </p></li>
<li><p><strong>llm</strong> (<a class="reference internal" href="../language_models/langchain_core.language_models.llms.LLM.html#langchain_core.language_models.llms.LLM" title="langchain_core.language_models.llms.LLM"><em>LLM</em></a>) – </p></li>
<li><p><strong>stop</strong> (<em>list</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>tuple[str, RETURN_VAL_TYPE] | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="langchain_astradb.cache.AstraDBSemanticCache.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prompt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">llm_string</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_val</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../outputs/langchain_core.outputs.generation.Generation.html#langchain_core.outputs.generation.Generation" title="langchain_core.outputs.generation.Generation"><span class="pre">Generation</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/langchain_astradb/cache.html#AstraDBSemanticCache.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#langchain_astradb.cache.AstraDBSemanticCache.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update cache based on prompt and llm_string.</p>
<p>The prompt and llm_string are used to generate a key for the cache.
The key should match that of the lookup method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prompt</strong> (<em>str</em>) – a string representation of the prompt.
In the case of a Chat model, the prompt is a non-trivial
serialization of the prompt into the language model.</p></li>
<li><p><strong>llm_string</strong> (<em>str</em>) – A string representation of the LLM configuration.
This is used to capture the invocation parameters of the LLM
(e.g., model name, temperature, stop tokens, max tokens, etc.).
These invocation parameters are serialized into a string
representation.</p></li>
<li><p><strong>return_val</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="../outputs/langchain_core.outputs.generation.Generation.html#langchain_core.outputs.generation.Generation" title="langchain_core.outputs.generation.Generation"><em>Generation</em></a><em>]</em>) – The value to be cached. The value is a list of Generations
(or subclasses).</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<ul class="simple">
</ul>
</section>


            </div>
            <div class="container">
                <footer class="sk-content-footer">
                                &copy; 2023, LangChain, Inc.
                                    .
                            Last updated
                                on Dec 06, 2024.
                </footer>
            </div>
        </div>
    </div>
<script src="../_static/js/vendor/bootstrap.min.js"></script>
<script>
$(document).ready(function() {
    /* Add a [>>>] button on the top-right corner of code samples to hide
     * the >>> and ... prompts and the output and thus make the code
     * copyable. */
    var div = $('.highlight-python .highlight,' +
                '.highlight-python3 .highlight,' +
                '.highlight-pycon .highlight,' +
		'.highlight-default .highlight')
    var pre = div.find('pre');

    // get the styles from the current theme
    pre.parent().parent().css('position', 'relative');
    var hide_text = 'Hide prompts and outputs';
    var show_text = 'Show prompts and outputs';

    // create and add the button to all the code blocks that contain >>>
    div.each(function(index) {
        var jthis = $(this);
        if (jthis.find('.gp').length > 0) {
            var button = $('<span class="copybutton">&gt;&gt;&gt;</span>');
            button.attr('title', hide_text);
            button.data('hidden', 'false');
            jthis.prepend(button);
        }
        // tracebacks (.gt) contain bare text elements that need to be
        // wrapped in a span to work with .nextUntil() (see later)
        jthis.find('pre:has(.gt)').contents().filter(function() {
            return ((this.nodeType == 3) && (this.data.trim().length > 0));
        }).wrap('<span>');
    });

    // define the behavior of the button when it's clicked
    $('.copybutton').click(function(e){
        e.preventDefault();
        var button = $(this);
        if (button.data('hidden') === 'false') {
            // hide the code output
            button.parent().find('.go, .gp, .gt').hide();
            button.next('pre').find('.gt').nextUntil('.gp, .go').css('visibility', 'hidden');
            button.css('text-decoration', 'line-through');
            button.attr('title', show_text);
            button.data('hidden', 'true');
        } else {
            // show the code output
            button.parent().find('.go, .gp, .gt').show();
            button.next('pre').find('.gt').nextUntil('.gp, .go').css('visibility', 'visible');
            button.css('text-decoration', 'none');
            button.attr('title', hide_text);
            button.data('hidden', 'false');
        }
    });

	/*** Add permalink buttons next to glossary terms ***/
	$('dl.glossary > dt[id]').append(function() {
		return ('<a class="headerlink" href="#' +
			    this.getAttribute('id') +
			    '" title="Permalink to this term">¶</a>');
	});
});

</script>
    
</body>
</html>